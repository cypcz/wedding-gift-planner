datasource postgresql {
  url = "***"
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id    String @id
  email String @unique

  guest     Guest[]
  wedding   Wedding? @relation(fields: [weddingId], references: [id])
  weddingId String?
}

enum GuestStatus {
  WAITING
  ACCEPTED
  REJECTED
}

model Guest {
  id         String      @id @default(cuid())
  firstName  String
  lastName   String
  plusX      Int         @default(0)
  plusGuests String[]
  guestLink  String
  status     GuestStatus @default(WAITING)

  wedding       Wedding            @relation(fields: [weddingId], references: [id])
  weddingId     String
  user          User?              @relation(fields: [userId], references: [id])
  userId        String?
  contributions GiftContribution[]
}

model Wedding {
  id           String   @id @default(cuid())
  partner1Name String
  partner2Name String
  date         DateTime

  gifts   Gift[]
  guests  Guest[]
  authors User[]
}

enum Currency {
  EUR
  USD
  CZK
  UAH
  RUB
  GBP
  HUF
  AUD
  NZD
}

model GiftContribution {
  id       String   @id @default(cuid())
  amount   Int
  currency Currency
  note     String?

  contributors Guest[]
  gift         Gift    @relation(fields: [giftId], references: [id])
  giftId       String
}

model Gift {
  id          String   @id @default(cuid())
  name        String
  price       Int
  currency    Currency
  description String?
  imgUrl      String?
  link        String?

  contributions GiftContribution[]
  wedding       Wedding            @relation(fields: [weddingId], references: [id])
  weddingId     String
}
