# Migration `20200912204602-guest`

This migration has been generated by Jakub at 9/12/2020, 10:46:02 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."_UserToWedding" DROP CONSTRAINT "_UserToWedding_A_fkey"

ALTER TABLE "public"."_UserToWedding" DROP CONSTRAINT "_UserToWedding_B_fkey"

ALTER TABLE "public"."User" ADD COLUMN "weddingId" text   

ALTER TABLE "public"."User" ADD FOREIGN KEY ("weddingId")REFERENCES "public"."Wedding"("id") ON DELETE SET NULL ON UPDATE CASCADE

DROP TABLE "public"."_UserToWedding"

ALTER INDEX "public"."User.email" RENAME TO "User.email_unique"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200905100922-email..20200912204602-guest
--- datamodel.dml
+++ datamodel.dml
@@ -1,6 +1,6 @@
 datasource postgresql {
-  url = "***"
+  url = "***"
   provider = "postgresql"
 }
 generator client {
@@ -9,19 +9,39 @@
 model User {
   id    String @id
   email String @unique
+
+  guest     Guest[]
+  wedding   Wedding? @relation(fields: [weddingId], references: [id])
+  weddingId String?
 }
+model Guest {
+  id         String   @id @default(cuid())
+  plusX      Int      @default(0)
+  plusGuests String[]
+  guestLink  String
+
+  wedding Wedding[]
+  user    User?     @relation(fields: [userId], references: [id])
+  userId  String?
+}
+
 model Wedding {
-  id     String   @id @default(cuid())
-  name   String
+  id           String   @id @default(cuid())
+  partner1Name String
+  partner2Name String
+  date         DateTime
+
   gifts  Gift[]
-  guests String[]
+  guests Guest[]
+  users  User[]
 }
 model Gift {
-  id        String  @id @default(cuid())
-  name      String
+  id   String @id @default(cuid())
+  name String
+
   wedding   Wedding @relation(fields: [weddingId], references: [id])
   weddingId String
 }
```


